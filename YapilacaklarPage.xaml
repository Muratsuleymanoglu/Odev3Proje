<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             x:Class="Odev3Proje.YapilacaklarPage"
             Title="YapÄ±lacaklar"
             BackgroundColor="{AppThemeBinding Light=#F0F0F0, Dark=#121212}">

    <Grid RowDefinitions="*, Auto" Padding="10">

        <ActivityIndicator x:Name="loading" IsRunning="False" IsVisible="False" 
                           Color="#512BD4" HorizontalOptions="Center" VerticalOptions="Start"/>

        <CollectionView x:Name="cvGorevler" Grid.Row="0">
            <CollectionView.ItemsLayout>
                <LinearItemsLayout Orientation="Vertical" ItemSpacing="10"/>
            </CollectionView.ItemsLayout>
            <CollectionView.ItemTemplate>
                <DataTemplate>
                    <Frame Padding="10" CornerRadius="10" HasShadow="True" BorderColor="#512BD4"
                           BackgroundColor="{AppThemeBinding Light=White, Dark=#1F1F1F}">

                        <Grid ColumnDefinitions="Auto, *, Auto, Auto">

                            <CheckBox IsChecked="{Binding YapildiMi}" 
                                      VerticalOptions="Center" 
                                      CheckedChanged="CheckBox_CheckedChanged"/>

                            <StackLayout Grid.Column="1" VerticalOptions="Center" Margin="10,0">
                                <Label Text="{Binding Baslik}" 
                                       FontAttributes="Bold" 
                                       FontSize="16" 
                                       TextColor="{AppThemeBinding Light=Black, Dark=White}"
                                       TextDecorations="{Binding YapildiMi, Converter={StaticResource BoolToStrikethroughConverter}}"/>
                                <Label Text="{Binding Detay}" 
                                       FontSize="12" 
                                       TextColor="Gray" 
                                       MaxLines="1" 
                                       LineBreakMode="TailTruncation"/>

                                <Label Text="{Binding TarihSaat, StringFormat='{0:dd.MM.yyyy HH:mm}'}" 
                                       FontSize="10" 
                                       TextColor="#512BD4"/>
                            </StackLayout>

                            <Button Text="âœŽ" 
                                    Grid.Column="2"
                                    TextColor="White"
                                    BackgroundColor="#512BD4"
                                    FontAttributes="Bold"
                                    FontSize="18"
                                    HeightRequest="40"
                                    WidthRequest="40"
                                    CornerRadius="20"
                                    Margin="0,0,5,0"
                                    Padding="0"
                                    Clicked="Edit_Clicked"
                                    CommandParameter="{Binding .}"/>

                            <Button Text="ðŸ—‘" 
                                    Grid.Column="3"
                                    TextColor="White"
                                    BackgroundColor="#D32F2F"
                                    FontAttributes="Bold"
                                    FontSize="18"
                                    HeightRequest="40"
                                    WidthRequest="40"
                                    CornerRadius="20"
                                    Padding="0"
                                    Clicked="Delete_Clicked"
                                    CommandParameter="{Binding .}"/>
                        </Grid>
                    </Frame>
                </DataTemplate>
            </CollectionView.ItemTemplate>
        </CollectionView>

        <Button Text="+" 
                Grid.Row="1"
                BackgroundColor="#512BD4"
                TextColor="Gray"
                FontSize="30"
                CornerRadius="30"
                HeightRequest="60"
                WidthRequest="60"
                HorizontalOptions="End"
                Margin="10"
                Clicked="Ekle_Clicked"
                Shadow="{Shadow Brush=Black, Offset='2,2', Opacity=0.5}"/>
    </Grid>
</ContentPage>